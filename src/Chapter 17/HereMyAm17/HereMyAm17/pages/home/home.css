#mainContent {
    height: 100%;
    display: -ms-grid;
    -ms-grid-columns: 1fr;
    -ms-grid-rows: 133px 1fr 60px;
}

#header {
    -ms-grid-column: 1;
    -ms-grid-row: 1;
    display: -ms-grid;
    -ms-grid-columns: 120px 1fr 40px;
    -ms-grid-rows: 1fr;

}

#header:-ms-lang(ar, dv, fa, he, ku-Arab, pa-Arab, prs, ps, sd-Arab, syr, ug, ur, qps-plocm) {
    /* Always run the header left to right since we don't localize the app name, but keep it right-aligned */
    direction: ltr;
    unicode-bidi: bidi-override;
    text-align: right;
}

#section {
    -ms-grid-column: 1;
    -ms-grid-row: 2;
    display: -ms-grid;
    -ms-grid-columns: 120px 1fr 40px 1fr 40px;
    -ms-grid-rows: 1fr;
}

.titlearea {
    -ms-grid-column: 2;
    margin-top: 37px;
}

#photoSection {
    -ms-grid-column: 2;
    -ms-grid-row: 1;
}

#locationSection {
    -ms-grid-column: 4;
    -ms-grid-row: 1;
}

.subsection {
    display: -ms-grid;
    -ms-grid-rows: 40px 1fr;
    -ms-grid-columns: 1fr;
}

.group-title {
    -ms-grid-column: 1;
    -ms-grid-row: 1;
}

.graphic {
    -ms-grid-column: 1;
    -ms-grid-row: 2;
    width: 100%;
    height: 100%;

    /* This is necessary for Bing Maps to infer the right size and position, otherwise it goes full screen. */
    position: relative;
}

#floatingError {
    /* This partly opaque error floats on top of the map iframe, partway from the top.
        It's initially hidden and is shown if there's a geolocation error. */    
    display: none;
    float: left;
    -ms-grid-column: 1;
    -ms-grid-row: 2;
    -ms-grid-row-align: start;
    width: 100%;
    text-align: center;
    background-color: rgba(128, 0, 0, 0.5);
    margin-top: 20%;
    position: relative;    
}

#errorImage {
    display: none;
    width: 100%;
    height: 100%;
}

#photoSrc {
    display: none;
}


@media screen and (-ms-view-state: fullscreen-landscape)
{
}

@media screen and (-ms-view-state: filled)
{
}

@media screen and (-ms-view-state: snapped)
{	
	#mainContent {
		-ms-grid-rows: 128px 1fr 10px;
	}

	#header {
		-ms-grid-columns: 20px 1fr 10px;
	}

	#section {
		-ms-grid-columns: 20px 1fr 10px;
		-ms-grid-rows: 1fr 20px 1fr;
	}

    .titlearea {		
	    margin-top: 69px;
    }

    #photoSection {
	    -ms-grid-column: 2;
	    -ms-grid-row: 1;
    }

    #locationSection {
	    -ms-grid-column: 2;
	    -ms-grid-row: 3;
    }

    .subsection {		
	    -ms-grid-rows: 20px 1fr;		
    }
}

@media screen and (-ms-view-state: fullscreen-portrait)
{	
    #header {
	    -ms-grid-columns: 100px 1fr 30px;
    }

    #section {
	    -ms-grid-columns: 100px 1fr 30px;
	    -ms-grid-rows: 1fr 30px 1fr;
    }

    #photoSection {
	    -ms-grid-column: 2;
	    -ms-grid-row: 1;
    }

    #locationSection {
	    -ms-grid-column: 2;
	    -ms-grid-row: 3;
    }
}